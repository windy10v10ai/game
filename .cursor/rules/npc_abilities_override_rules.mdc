# NPC Abilities Override 编辑规则

## 基础原则

1. **以原版文件为基础**：始终以原版（npc_data_hero_xxx）文件为基础进行override
2. **移除不存在的kv**：当原版中不存在某个kv时，从override文件中移除
3. **移除与原版一致的数值**：当override文件中的数值与原版完全一致时，应该从override文件中移除这些条目，避免重复

## 数值设置规则

### MaxLevel扩展

- 根据MaxLevel的数字，决定设置多少个数值
- 多增加的数值保持等差数列
- 基础等级的数值和原版一致，只添加额外等级数值，不需要备注原版数值

### 备注和差值处理

- 当override的基础数值与原版不一致时，备注的是之前版本的数值
- 参照实际value和备注的区别，保持增强或削弱的倍率，或者差值
- 如果override的备注中写了+多少，x多少时，同步时对数值进行相应的加减
- 如果override的数值与备注的数值存在差值时，同步时候保持此差值

### 特殊数值处理

- 对于AbilityCooldown或者百分比（pct）数值，在确保最高等级的数值和原版一致的前提下，适当调整1级的数值，或减少每一级的差值，使得每一级的数值都是整数
- **数值优化原则**：对于单一数值，修改后的值尽可能保持接近整数（如10、100等整数值），可以适当微调差值来实现这个目标

## 格式要求

- 尽量保持tab的缩进一致
- value，备注的缩进尽量一致

## 移除规则

### 单一数值技能

- 对于只有一个数值的技能，除非数值和原版不一致，否则移除

### 不需要复制的kv

除非有单独改动，移除没有改动的kv，不需要复制下列kv：

- special_bonus_xxx（除非有修改）
- affected_by_aoe_increase

### 与原版一致的条目

- **重要**：当override文件中的数值与原版完全一致时，应该移除这些条目
- 例如：如果原版已经是`"special_bonus_unique_nyx_6" "+0.6"`，则不需要在override中重复写入

## 搜索技巧

### 在override文件中搜索技能

- **重要**：在override中搜索时，可以使用多种方法：
  1. **英雄内部名称和技能内部名称**：最精确的搜索方法
  2. **中文技能名称或注释**：override文件中通常有中文注释
  3. **特征数值**：搜索更新日志中提到的特定数值

#### 搜索方法

- 英雄名称通常是英文名称（如grimstroke、marci、nyx_assassin等）
- 技能名称格式：`英雄名_技能名`（如grimstroke_spirit_walk、marci_grapple等）
- 中文搜索：直接搜索中文技能名或英雄名
- 数值搜索：搜索更新日志中的关键数值

### 搜索示例

```bash
# 方法1：使用内部技能名称（最精确）
grep "grimstroke_spirit_walk"

# 方法2：使用英雄内部名称
grep "marci_"
grep "undying_"

# 方法3：使用中文名称搜索
grep "墨涌"
grep "不朽尸王"
grep "天涯墨客"

# 方法4：使用特征数值搜索
grep "1\.3.*1\.8.*2\.3.*2\.8"  # 搜索墨涌的眩晕时间
grep "+40.*腐朽"              # 搜索不朽尸王腐朽天赋
```

## 同步更新日志的工作流程

1. 分析更新日志中提到的所有英雄技能变更
2. **使用英雄和技能内部名称搜索override文件**
3. 检查原版文件中的当前数值（原版文件已经是更新后的）
4. 对于override文件中存在的技能：
   - 如果override数值与原版一致 → 移除override条目
   - 如果override数值与原版不同 → 按照差值/倍率规则调整
   - 如果是扩展等级 → 保持扩展并调整数值
5. 对于override文件中不存在的技能：
   - 如果原版已经是目标数值 → 不需要添加override
   - 如果需要自定义修改 → 添加override条目

## 示例

### 天赋同步示例

```
// 错误：与原版一致的天赋不应该保留
"special_bonus_unique_nyx_6"	"+0.6"	// 原版0.6

// 正确：移除与原版一致的条目，只保留有差异的
// （如果原版是+0.6，override不需要写入）
```

### 数值扩展示例

```
// 原版4级：30/26/22/18
// Override扩展为5级，保持等差：30/26/22/18/14
"AbilityCooldown"	"30 26 22 18 14"
```

### 差值保持示例

```
// 原版：+30，备注显示之前是+40，差值+10
// 新原版：+25，应该调整为：25+10=35
"special_bonus_unique_example"	"+35"	// 原版25 +10差值
```

### 数值优化示例

```
// 原版：+10，之前override是+28（+18差值）
// 如果严格按差值：新值应该是10+18=28
// 但28不是整数值，可以微调差值为+20，使结果为30（更接近整数）
"special_bonus_unique_abaddon_7"	"+30"	// 原版10 +20差值

// 原版：+100，之前override是+150（+50差值）
// 新原版：+90，严格按差值应该是90+50=140
// 但可以微调差值为+60，使结果为150（保持整数）
"special_bonus_unique_example"	"+150"	// 原版90 +60差值
```
